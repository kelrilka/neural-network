# neural-network

Для запуска использовать команду:

```python
python3 NEDS.py
```

Для продолжения выполнения кода надо закрывать окна с графиками :)

```
   duration protocol_type  ... dst_host_srv_rerror_rate    class
0         0           tcp  ...                     0.00   normal
1         0           udp  ...                     0.00   normal
2         0           tcp  ...                     0.00  anomaly
3         0           tcp  ...                     0.01   normal

[4 rows x 42 columns]
Training data has 25192 rows & 42 columns
   duration protocol_type  ... dst_host_rerror_rate dst_host_srv_rerror_rate
0         0           tcp  ...                  1.0                      1.0
1         0           tcp  ...                  1.0                      1.0
2         2           tcp  ...                  0.0                      0.0
3         0          icmp  ...                  0.0                      0.0

[4 rows x 41 columns]
Testing data has 22544 rows & 41 columns
0    25192
Name: num_outbound_cmds, dtype: int64
0    22544
Name: num_outbound_cmds, dtype: int64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 8)                 128       
                                                                 
 dense_1 (Dense)             (None, 8)                 72        
                                                                 
 dense_2 (Dense)             (None, 1)                 9         
                                                                 
=================================================================
Total params: 209
Trainable params: 209
Non-trainable params: 0
_________________________________________________________________
Epoch 1/20
  1/395 [..............................] - ETA: 3:59 - loss: 0.6931 - accuracy: 0.9062
 57/395 [===>..........................] - ETA: 0s - loss: 0.6879 - accuracy: 0.8092  
115/395 [=======>......................] - ETA: 0s - loss: 0.6357 - accuracy: 0.8340
180/395 [============>.................] - ETA: 0s - loss: 0.5279 - accuracy: 0.8552
234/395 [================>.............] - ETA: 0s - loss: 0.4651 - accuracy: 0.8669
294/395 [=====================>........] - ETA: 0s - loss: 0.4138 - accuracy: 0.8765
360/395 [==========================>...] - ETA: 0s - loss: 0.3760 - accuracy: 0.8830
395/395 [==============================] - 1s 2ms/step - loss: 0.3606 - accuracy: 0.8859 - val_loss: 0.1966 - val_accuracy: 0.9148
Epoch 2/20
  1/395 [..............................] - ETA: 0s - loss: 0.1608 - accuracy: 0.9375
 68/395 [====>.........................] - ETA: 0s - loss: 0.1786 - accuracy: 0.9306
131/395 [========>.....................] - ETA: 0s - loss: 0.1727 - accuracy: 0.9325
196/395 [=============>................] - ETA: 0s - loss: 0.1685 - accuracy: 0.9334
261/395 [==================>...........] - ETA: 0s - loss: 0.1692 - accuracy: 0.9321
329/395 [=======================>......] - ETA: 0s - loss: 0.1687 - accuracy: 0.9343
395/395 [==============================] - 0s 1ms/step - loss: 0.1652 - accuracy: 0.9361 - val_loss: 0.1505 - val_accuracy: 0.9410
Epoch 3/20
  1/395 [..............................] - ETA: 0s - loss: 0.1372 - accuracy: 0.9375
 68/395 [====>.........................] - ETA: 0s - loss: 0.1494 - accuracy: 0.9407
136/395 [=========>....................] - ETA: 0s - loss: 0.1500 - accuracy: 0.9426
204/395 [==============>...............] - ETA: 0s - loss: 0.1521 - accuracy: 0.9444
261/395 [==================>...........] - ETA: 0s - loss: 0.1492 - accuracy: 0.9435
330/395 [========================>.....] - ETA: 0s - loss: 0.1499 - accuracy: 0.9433
394/395 [============================>.] - ETA: 0s - loss: 0.1477 - accuracy: 0.9454
395/395 [==============================] - 0s 1ms/step - loss: 0.1480 - accuracy: 0.9452 - val_loss: 0.1412 - val_accuracy: 0.9476
Epoch 4/20
  1/395 [..............................] - ETA: 0s - loss: 0.1803 - accuracy: 0.9062
 70/395 [====>.........................] - ETA: 0s - loss: 0.1403 - accuracy: 0.9491
139/395 [=========>....................] - ETA: 0s - loss: 0.1395 - accuracy: 0.9483
206/395 [==============>...............] - ETA: 0s - loss: 0.1432 - accuracy: 0.9468
275/395 [===================>..........] - ETA: 0s - loss: 0.1402 - accuracy: 0.9481
342/395 [========================>.....] - ETA: 0s - loss: 0.1406 - accuracy: 0.9476
395/395 [==============================] - 0s 1ms/step - loss: 0.1398 - accuracy: 0.9478 - val_loss: 0.1415 - val_accuracy: 0.9508
Epoch 5/20
  1/395 [..............................] - ETA: 0s - loss: 0.1481 - accuracy: 0.9062
 68/395 [====>.........................] - ETA: 0s - loss: 0.1501 - accuracy: 0.9472
136/395 [=========>....................] - ETA: 0s - loss: 0.1481 - accuracy: 0.9469
206/395 [==============>...............] - ETA: 0s - loss: 0.1385 - accuracy: 0.9504
275/395 [===================>..........] - ETA: 0s - loss: 0.1378 - accuracy: 0.9498
341/395 [========================>.....] - ETA: 0s - loss: 0.1369 - accuracy: 0.9498
395/395 [==============================] - 0s 1ms/step - loss: 0.1345 - accuracy: 0.9506 - val_loss: 0.1287 - val_accuracy: 0.9574
Epoch 6/20
  1/395 [..............................] - ETA: 0s - loss: 0.0533 - accuracy: 0.9688
 67/395 [====>.........................] - ETA: 0s - loss: 0.1266 - accuracy: 0.9515
133/395 [=========>....................] - ETA: 0s - loss: 0.1268 - accuracy: 0.9532
202/395 [==============>...............] - ETA: 0s - loss: 0.1222 - accuracy: 0.9558
270/395 [===================>..........] - ETA: 0s - loss: 0.1283 - accuracy: 0.9542
339/395 [========================>.....] - ETA: 0s - loss: 0.1298 - accuracy: 0.9536
395/395 [==============================] - 0s 1ms/step - loss: 0.1289 - accuracy: 0.9542 - val_loss: 0.1277 - val_accuracy: 0.9552
Epoch 7/20
  1/395 [..............................] - ETA: 0s - loss: 0.2106 - accuracy: 0.9062
 68/395 [====>.........................] - ETA: 0s - loss: 0.1244 - accuracy: 0.9550
138/395 [=========>....................] - ETA: 0s - loss: 0.1276 - accuracy: 0.9549
206/395 [==============>...............] - ETA: 0s - loss: 0.1299 - accuracy: 0.9519
274/395 [===================>..........] - ETA: 0s - loss: 0.1255 - accuracy: 0.9543
343/395 [=========================>....] - ETA: 0s - loss: 0.1249 - accuracy: 0.9556
395/395 [==============================] - 0s 1ms/step - loss: 0.1263 - accuracy: 0.9547 - val_loss: 0.1221 - val_accuracy: 0.9614
Epoch 8/20
  1/395 [..............................] - ETA: 0s - loss: 0.0507 - accuracy: 1.0000
 68/395 [====>.........................] - ETA: 0s - loss: 0.1237 - accuracy: 0.9573
137/395 [=========>....................] - ETA: 0s - loss: 0.1172 - accuracy: 0.9583
202/395 [==============>...............] - ETA: 0s - loss: 0.1168 - accuracy: 0.9595
263/395 [==================>...........] - ETA: 0s - loss: 0.1184 - accuracy: 0.9603
331/395 [========================>.....] - ETA: 0s - loss: 0.1184 - accuracy: 0.9603
392/395 [============================>.] - ETA: 0s - loss: 0.1182 - accuracy: 0.9601
395/395 [==============================] - 0s 1ms/step - loss: 0.1182 - accuracy: 0.9600 - val_loss: 0.1156 - val_accuracy: 0.9634
Epoch 9/20
  1/395 [..............................] - ETA: 0s - loss: 0.2812 - accuracy: 0.8750
 70/395 [====>.........................] - ETA: 0s - loss: 0.1154 - accuracy: 0.9612
137/395 [=========>....................] - ETA: 0s - loss: 0.1185 - accuracy: 0.9596
199/395 [==============>...............] - ETA: 0s - loss: 0.1172 - accuracy: 0.9607
261/395 [==================>...........] - ETA: 0s - loss: 0.1148 - accuracy: 0.9617
327/395 [=======================>......] - ETA: 0s - loss: 0.1133 - accuracy: 0.9615
395/395 [==============================] - 0s 1ms/step - loss: 0.1127 - accuracy: 0.9622 - val_loss: 0.1106 - val_accuracy: 0.9660
Epoch 10/20
  1/395 [..............................] - ETA: 0s - loss: 0.1508 - accuracy: 0.8750
 68/395 [====>.........................] - ETA: 0s - loss: 0.1103 - accuracy: 0.9619
138/395 [=========>....................] - ETA: 0s - loss: 0.1133 - accuracy: 0.9613
203/395 [==============>...............] - ETA: 0s - loss: 0.1110 - accuracy: 0.9635
268/395 [===================>..........] - ETA: 0s - loss: 0.1085 - accuracy: 0.9634
336/395 [========================>.....] - ETA: 0s - loss: 0.1069 - accuracy: 0.9645
395/395 [==============================] - 0s 1ms/step - loss: 0.1080 - accuracy: 0.9641 - val_loss: 0.1076 - val_accuracy: 0.9668
Epoch 11/20
  1/395 [..............................] - ETA: 0s - loss: 0.0394 - accuracy: 1.0000
 65/395 [===>..........................] - ETA: 0s - loss: 0.0851 - accuracy: 0.9731
134/395 [=========>....................] - ETA: 0s - loss: 0.0949 - accuracy: 0.9699
201/395 [==============>...............] - ETA: 0s - loss: 0.1005 - accuracy: 0.9678
269/395 [===================>..........] - ETA: 0s - loss: 0.0960 - accuracy: 0.9689
334/395 [========================>.....] - ETA: 0s - loss: 0.1011 - accuracy: 0.9678
395/395 [==============================] - 0s 1ms/step - loss: 0.1050 - accuracy: 0.9665 - val_loss: 0.1044 - val_accuracy: 0.9680
Epoch 12/20
  1/395 [..............................] - ETA: 0s - loss: 0.0288 - accuracy: 1.0000
 68/395 [====>.........................] - ETA: 0s - loss: 0.0915 - accuracy: 0.9729
135/395 [=========>....................] - ETA: 0s - loss: 0.1005 - accuracy: 0.9676
203/395 [==============>...............] - ETA: 0s - loss: 0.0975 - accuracy: 0.9671
272/395 [===================>..........] - ETA: 0s - loss: 0.1014 - accuracy: 0.9661
338/395 [========================>.....] - ETA: 0s - loss: 0.1034 - accuracy: 0.9662
395/395 [==============================] - 0s 1ms/step - loss: 0.1026 - accuracy: 0.9662 - val_loss: 0.1016 - val_accuracy: 0.9686
Epoch 13/20
  1/395 [..............................] - ETA: 0s - loss: 0.0950 - accuracy: 0.9688
 65/395 [===>..........................] - ETA: 0s - loss: 0.0957 - accuracy: 0.9688
129/395 [========>.....................] - ETA: 0s - loss: 0.0937 - accuracy: 0.9707
195/395 [=============>................] - ETA: 0s - loss: 0.0929 - accuracy: 0.9710
264/395 [===================>..........] - ETA: 0s - loss: 0.0986 - accuracy: 0.9680
331/395 [========================>.....] - ETA: 0s - loss: 0.1005 - accuracy: 0.9677
395/395 [==============================] - 0s 1ms/step - loss: 0.1001 - accuracy: 0.9676 - val_loss: 0.0991 - val_accuracy: 0.9702
Epoch 14/20
  1/395 [..............................] - ETA: 0s - loss: 0.0803 - accuracy: 0.9688
 69/395 [====>.........................] - ETA: 0s - loss: 0.0891 - accuracy: 0.9710
136/395 [=========>....................] - ETA: 0s - loss: 0.0976 - accuracy: 0.9688
204/395 [==============>...............] - ETA: 0s - loss: 0.0968 - accuracy: 0.9695
274/395 [===================>..........] - ETA: 0s - loss: 0.0949 - accuracy: 0.9703
343/395 [=========================>....] - ETA: 0s - loss: 0.0969 - accuracy: 0.9696
395/395 [==============================] - 0s 1ms/step - loss: 0.0987 - accuracy: 0.9684 - val_loss: 0.0999 - val_accuracy: 0.9702
Epoch 15/20
  1/395 [..............................] - ETA: 0s - loss: 0.0757 - accuracy: 0.9688
 67/395 [====>.........................] - ETA: 0s - loss: 0.0867 - accuracy: 0.9711
136/395 [=========>....................] - ETA: 0s - loss: 0.0898 - accuracy: 0.9722
205/395 [==============>...............] - ETA: 0s - loss: 0.0901 - accuracy: 0.9718
274/395 [===================>..........] - ETA: 0s - loss: 0.0924 - accuracy: 0.9708
343/395 [=========================>....] - ETA: 0s - loss: 0.0950 - accuracy: 0.9700
395/395 [==============================] - 0s 1ms/step - loss: 0.0964 - accuracy: 0.9693 - val_loss: 0.0999 - val_accuracy: 0.9700
Epoch 16/20
  1/395 [..............................] - ETA: 0s - loss: 0.0282 - accuracy: 1.0000
 68/395 [====>.........................] - ETA: 0s - loss: 0.1073 - accuracy: 0.9655
137/395 [=========>....................] - ETA: 0s - loss: 0.0967 - accuracy: 0.9681
206/395 [==============>...............] - ETA: 0s - loss: 0.0967 - accuracy: 0.9694
275/395 [===================>..........] - ETA: 0s - loss: 0.0934 - accuracy: 0.9700
345/395 [=========================>....] - ETA: 0s - loss: 0.0965 - accuracy: 0.9682
395/395 [==============================] - 0s 1ms/step - loss: 0.0949 - accuracy: 0.9686 - val_loss: 0.0966 - val_accuracy: 0.9700
Epoch 17/20
  1/395 [..............................] - ETA: 0s - loss: 0.1658 - accuracy: 0.9062
 70/395 [====>.........................] - ETA: 0s - loss: 0.0865 - accuracy: 0.9696
138/395 [=========>....................] - ETA: 0s - loss: 0.0897 - accuracy: 0.9708
206/395 [==============>...............] - ETA: 0s - loss: 0.0949 - accuracy: 0.9694
274/395 [===================>..........] - ETA: 0s - loss: 0.0917 - accuracy: 0.9702
343/395 [=========================>....] - ETA: 0s - loss: 0.0947 - accuracy: 0.9697
395/395 [==============================] - 0s 1ms/step - loss: 0.0939 - accuracy: 0.9696 - val_loss: 0.0938 - val_accuracy: 0.9722
Epoch 18/20
  1/395 [..............................] - ETA: 0s - loss: 0.1199 - accuracy: 0.9375
 67/395 [====>.........................] - ETA: 0s - loss: 0.1008 - accuracy: 0.9688
130/395 [========>.....................] - ETA: 0s - loss: 0.0933 - accuracy: 0.9707
197/395 [=============>................] - ETA: 0s - loss: 0.0925 - accuracy: 0.9714
261/395 [==================>...........] - ETA: 0s - loss: 0.0941 - accuracy: 0.9714
320/395 [=======================>......] - ETA: 0s - loss: 0.0931 - accuracy: 0.9710
389/395 [============================>.] - ETA: 0s - loss: 0.0918 - accuracy: 0.9708
395/395 [==============================] - 0s 1ms/step - loss: 0.0923 - accuracy: 0.9708 - val_loss: 0.0930 - val_accuracy: 0.9704
Epoch 19/20
  1/395 [..............................] - ETA: 0s - loss: 0.2744 - accuracy: 0.9062
 69/395 [====>.........................] - ETA: 0s - loss: 0.0977 - accuracy: 0.9692
136/395 [=========>....................] - ETA: 0s - loss: 0.0905 - accuracy: 0.9708
198/395 [==============>...............] - ETA: 0s - loss: 0.0863 - accuracy: 0.9713
264/395 [===================>..........] - ETA: 0s - loss: 0.0882 - accuracy: 0.9714
334/395 [========================>.....] - ETA: 0s - loss: 0.0875 - accuracy: 0.9715
395/395 [==============================] - 0s 1ms/step - loss: 0.0899 - accuracy: 0.9712 - val_loss: 0.0915 - val_accuracy: 0.9706
Epoch 20/20
  1/395 [..............................] - ETA: 0s - loss: 0.0806 - accuracy: 1.0000
 71/395 [====>.........................] - ETA: 0s - loss: 0.0848 - accuracy: 0.9723
137/395 [=========>....................] - ETA: 0s - loss: 0.0851 - accuracy: 0.9726
205/395 [==============>...............] - ETA: 0s - loss: 0.0884 - accuracy: 0.9712
274/395 [===================>..........] - ETA: 0s - loss: 0.0923 - accuracy: 0.9700
343/395 [=========================>....] - ETA: 0s - loss: 0.0920 - accuracy: 0.9698
395/395 [==============================] - 0s 1ms/step - loss: 0.0901 - accuracy: 0.9699 - val_loss: 0.0938 - val_accuracy: 0.9722

OK 

  1/237 [..............................] - ETA: 20s
 79/237 [=========>....................] - ETA: 0s 
173/237 [====================>.........] - ETA: 0s
237/237 [==============================] - 0s 581us/step
  1/395 [..............................] - ETA: 6s
 93/395 [======>.......................] - ETA: 0s
189/395 [=============>................] - ETA: 0s
284/395 [====================>.........] - ETA: 0s
382/395 [============================>.] - ETA: 0s
395/395 [==============================] - 0s 529us/step
  1/237 [..............................] - ETA: 3s
 90/237 [==========>...................] - ETA: 0s
189/237 [======================>.......] - ETA: 0s
237/237 [==============================] - 0s 526us/step

============================== ANN Model Test Results ==============================

Model Accuracy:
 0.9718179412543001


Classification report:
               precision    recall  f1-score   support

           0       0.98      0.95      0.97      3498
           1       0.96      0.99      0.97      4060

    accuracy                           0.97      7558
   macro avg       0.97      0.97      0.97      7558
weighted avg       0.97      0.97      0.97      7558


  1/705 [..............................] - ETA: 11s
 90/705 [==>...........................] - ETA: 0s 
189/705 [=======>......................] - ETA: 0s
285/705 [===========>..................] - ETA: 0s
379/705 [===============>..............] - ETA: 0s
468/705 [==================>...........] - ETA: 0s
567/705 [=======================>......] - ETA: 0s
652/705 [==========================>...] - ETA: 0s
705/705 [==============================] - 0s 571us/step
Anomaly
Anomaly
Normal
Anomaly
Anomaly
Normal
Normal
Normal
Normal
Normal
Normal
Normal
Anomaly
Anomaly
Normal
Normal
Normal
Normal
Anomaly
Anomaly
Anomaly
Normal
Normal
Normal
Anomaly
Anomaly
Normal
Normal
Anomaly
Anomaly
Normal
Normal
Normal
Anomaly
Anomaly
Anomaly
Normal
Normal
Normal
Normal
Anomaly
Normal
Normal
Normal
Anomaly
Normal
Anomaly
Normal
Normal
Normal
Normal
Normal
Anomaly
Anomaly
Normal
Normal
Anomaly
Normal
Normal
Normal
Normal
Anomaly
Normal
Normal
Anomaly
Normal
Anomaly
Anomaly
Anomaly
Normal
Anomaly
Normal
Normal
Normal
Anomaly
Normal
Normal
Normal
Normal
Normal
Anomaly
Anomaly
Anomaly
Normal
Normal
Normal
Anomaly
Normal
Normal
Normal
Normal
Normal
Anomaly
Anomaly
Normal
Normal
Normal
Normal
Anomaly
Anomaly
```